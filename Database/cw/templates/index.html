<!DOCTYPE html>
<html>
  <head>
    <title>World</title>
    <link href="./templates/style.css" rel="stylesheet" type="text/css" />
  </head>

  <script
    src="./templates/components/nav.js"
    type="text/javascript"
    defer
  ></script>
  <script
    src="./templates/components/table.js"
    type="text/javascript"
    defer
  ></script>
  <script
    src="./templates/components/select.js"
    type="text/javascript"
    defer
  ></script>

  <script defer>
    function selectCasesByMonth() {
      const selectedDate = document.getElementById(
        "covidVaccinationDate"
      ).value;
      return fetch(`/api/covidVaccination/world?date=${selectedDate}`)
        .then((response) => response.json())
        .then(({ covidVaccination, totalCovid, totalVaccination }) => {
          covidVaccination.push({
            date: "<b>Total</b>",
            ...totalCovid,
            ...totalVaccination,
          });
          const header =
            selectedDate !== "all"
              ? [
                  "Date",
                  "Daily Case",
                  "Daily Death",
                  "Daily Vaccination",
                  "Daily Unique Vaccinated People",
                ]
              : [
                  "Date",
                  "Total Case",
                  "Total Death",
                  "Total Vaccination",
                  "Total Unique Vaccinated People",
                ];
          loadTable(covidVaccination, header, "covidVaccination");
        });
    }

    function selectCovidHospitalizeByMonth() {
      const selectedDate = document.getElementById(
        "covidHospitalizeDate"
      ).value;
      return fetch(`/api/hospitalize/world?date=${selectedDate}`)
        .then((response) => response.json())
        .then(({ covidHospitalize, totalCovid, totalCovidHospitalize }) => {
          covidHospitalize.push({
            date: "<b>Total</b>",
            ...totalCovid,
            ...totalCovidHospitalize,
          });
          const header =
            selectedDate !== "all"
              ? [
                  "Date",
                  "Daily Case",
                  "Daily Death",
                  "Daily ICU Patient",
                  "Daily Hospitalize Patient",
                ]
              : [
                  "Date",
                  "Total Case",
                  "Total Death",
                  "Total ICU Patient",
                  "Total Hospitalize Patient",
                ];
          loadTable(covidHospitalize, header, "covidHospitalize");
        });
    }
  </script>
  <body>
    <div id="myNav"></div>
    <div class="container">
      <h1>World Data</h1>
      <h3>Total Population: {{population.total_population}}</h3>

      <div class="row">
        <div class="container">
          <div class="titleContainer">
            <h3>Covid Cases And Vaccination</h3>
            <div>
              Filter:
              <select
                name="Filter By Date"
                id="covidVaccinationDate"
                onchange="selectCasesByMonth()"
              >
                <option value="all">All</option>
                {{#covidVaccination}}
                <option value="{{date}}">{{date}}</option>
                {{/covidVaccination}}
              </select>
            </div>
          </div>

          <table id="covidVaccination" border="solid">
            <tr>
              <th>Date</th>
              <th>Total Case</th>
              <th>Total Death</th>
              <th>Total Vaccination</th>
              <th>Total Unique Vaccinated People</th>
            </tr>

            {{#covidVaccination}}
            <tr>
              <td>{{date}}</td>
              <td>{{total_case}}</td>
              <td>{{total_death}}</td>
              <td>{{total_vaccinations}}</td>
              <td>{{total_unique_vaccinated_people}}</td>
            </tr>
            {{/covidVaccination}}

            <tr>
              <td><b>Total</b></td>
              <td>{{totalCovid.total_case}}</td>
              <td>{{totalCovid.total_death}}</td>
              <td>{{totalVaccination.total_vaccinations}}</td>
              <td>{{totalVaccination.total_unique_vaccinated_people}}</td>
            </tr>
          </table>
        </div>
      </div>

      <div class="row" style="margin-top: 20px">
        <div class="container">
          <div class="titleContainer">
            <h3>Covid Cases And Hospitalization</h3>
            <div>
              Filter:
              <select
                name="Filter By Date"
                id="covidHospitalizeDate"
                onchange="selectCovidHospitalizeByMonth()"
              >
                <option value="all">All</option>
                {{#covidHospitalize}}
                <option value="{{date}}">{{date}}</option>
                {{/covidHospitalize}}
              </select>
            </div>
          </div>

          <table id="covidHospitalize" border="solid">
            <tr>
              <th>Date</th>
              <th>Total Case</th>
              <th>Total Death</th>
              <th>Total ICU Patient</th>
              <th>Total Hospitalize Patient</th>
            </tr>

            {{#covidHospitalize}}
            <tr>
              <td>{{date}}</td>
              <td>{{total_case}}</td>
              <td>{{total_death}}</td>
              <td>{{total_icu_patient}}</td>
              <td>{{total_hosp_patients}}</td>
            </tr>
            {{/covidHospitalize}}

            <tr>
              <td><b>Total</b></td>
              <td>{{totalCovid.total_case}}</td>
              <td>{{totalCovid.total_death}}</td>
              <td>{{totalCovidHospitalize.total_icu_patient}}</td>
              <td>{{totalCovidHospitalize.total_hosp_patients}}</td>
            </tr>
          </table>
        </div>
      </div>

      <div class="row" style="margin-top: 20px">
        <div class="container">
          <h3>Covid Cases Against Population</h3>

          <table id="covidHospitalize" border="solid">
            <tr>
              <th>Country</th>
              <th>Population</th>
              <th>Total Covid Case</th>
              <th>Total Covid Case Against Population</th>
              <th>Population Density</th>
            </tr>

            {{#covidByPopulation}}
            <tr>
              <td>{{country}}</td>
              <td>{{population}}</td>
              <td>{{total_case}}</td>
              <td>{{total_covid_against_population}}</td>
              <td>{{population_density}}</td>
            </tr>
            {{/covidByPopulation}}
          </table>
        </div>
      </div>
    </div>
  </body>
</html>
